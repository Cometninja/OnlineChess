<!DOCTYPE html>

<body>
    <h1 style="position: relative;">
        Welcome to chess!!
    </h1>


    <div id="startpos" class="square" style="left: 100px; position: relative;"></div>

    <button onclick="myfunction(document.getElementById('startpos'))">Start</button>

    <script src="scripts.js"></script>

    <img src="BlackKing.png" alt="BlackKing" id="blackKing" style="position: relative; visibility: hidden;">
    <img src="BlackQueen.png" alt="BlackQueen" id="blackQueen" style="position: relative; visibility: hidden;">
    <img src="BlackRook.png" alt="BlackRook" id="blackRook" style="position: relative; visibility: hidden;">
    <img src="BlackKnight.png" alt="BlackKnight" id="blackKnight" style="position: relative; visibility: hidden;">
    <img src="BlackBishop.png" alt="BlackBishop" id="blackBishop" style="position: relative; visibility: hidden;">
    <img src="BlackPawn.png" alt="BlackPawn" id="blackPawn" style="position: relative; visibility: hidden;">
    <img src="WhiteKing.png" alt="WhiteKing" id="whiteKing" style="position: relative; visibility: hidden;">
    <img src="WhiteQueen.png" alt="WhiteQueen" id="whiteQueen" style="position: relative; visibility: hidden;">
    <img src="WhiteRook.png" alt="WhiteRook" id="whiteRook" style="position: relative; visibility: hidden;">
    <img src="WhiteKnight.png" alt="WhiteKnight" id="whiteKnight" style="position: relative; visibility: hidden;">
    <img src="WhiteBishop.png" alt="WhiteBishop" id="whiteBishop" style="position: relative; visibility: hidden;">
    <img src="WhitePawn.png" alt="WhitePawn" id="whitePawn" style="position: relative; visibility: hidden;">

    <textarea id="content" rows="4" cols="50" style="position: relative; top: 400px; left: 50px"></textarea>
    <button id="writeButton" onclick="writeToFile()" style="position: relative; left: 100px;">
        Write To File</button>

    <p id="display" style="position: relative; left: 600px;">here i am </p>

    <button id="read data" onclick="readChessBoard()" style="position: relative; top: 100px; left: 800px">
        readChessBoard</button>
    <script>

        class chessboardtile {
            constructor(_point, _colour, _containsPeice, _peice) {
                this._colour = _colour;
                this._point = _point;
                this._containsPeice = _containsPeice;
                this._peice = _peice;
            }

        }
        var last = "";
        var lastColor = "silver";

        async function myfunction(source) {

            let fullboard = [];
            let thing = await readChessBoard();
            console.log(thing);
            for (let i = 0; i < thing.length; i++) {
                fullboard[i] = thing[i];
            }
            let count = 0;
            console.log("i am here!!");
            const board = readChessBoard();
            console.log(fullboard.length);
            fullboard.forEach(element => {
                let tile = new chessboardtile(element._coordinate, element._colour, element._containsPiece, element._piece);
                const square = document.createElement("div");
                const para = document.createTextNode(tile._point.X + " " + tile._point.Y);

                square.className = "chessboardtile";

                square.style.position = "absolute";
                square.style.width = "50px";
                square.style.height = "50px";
                source.appendChild(square);
                square.style.color = "black";
                square.style.top = tile._point.X * 50 + "px";
                square.style.left = tile._point.Y * 50 + "px";
                square.id = tile._point.X + "," + tile._point.Y;



                square.onclick = function () { getCorodinate(this, tile) };

                if (tile._point.X % 2 == 0 && tile._point.Y % 2 == 0) {

                    square.style.backgroundColor = "silver";
                }
                else if (tile._point.X % 2 != 0 && tile._point.Y % 2 != 0) {

                    square.style.backgroundColor = "silver";

                }


                else {

                    square.style.backgroundColor = "gainsboro";
                }

                if (tile._containsPeice) {
                    let peice = document.getElementById(tile._colour + tile._peice);
                    let newPeice = document.createElement("img");
                    newPeice.src = peice.src;

                    console.log(tile._colour + tile._peice);
                    newPeice.style.top = "-20px";
                    square.appendChild(newPeice);

                }
            });
        }

        function getCorodinate(element, tile) {
            if (last != "") {
                last.style.backgroundColor = lastColor;
            }
            console.log(tile._point);
            console.log(tile._colour + " " + tile._peice);
            console.log(tile._containsPeice);
            lastColor = element.style.backgroundColor;
            last = element;
            element.style.backgroundColor = "red";

        }

        function writetoDatabase() {

        }
    </script>
</body>